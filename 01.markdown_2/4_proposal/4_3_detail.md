# 手法の詳細

本節では、NekoNetの各コンポーネントの技術的詳細を説明する。

## Cat Detector

Cat Detectorは、YOLOv8-nano[2]をベースに以下の改良を加えた検出モジュールである。

**バックボーン**：CSPDarknetをベースに、猫の特徴抽出に適した改良を加えた。具体的には、毛色パターンの検出に有効な低レベル特徴を保持するスキップ接続を追加した。

**ネック**：PANet（Path Aggregation Network）[10]を採用し、マルチスケールの特徴マップを統合する。これにより、大きさの異なる猫（子猫から成猫まで）を同一モデルで検出可能とした。

**ヘッド**：アンカーフリーの検出ヘッドを採用し、猫の多様な姿勢に対応する。

## Breed Classifier

Breed Classifierは、細粒度画像認識のための分類モジュールである。

**マルチスケール特徴抽出**：猫の顔（256×256）、上半身（384×384）、全身（512×512）の3つのスケールで特徴を抽出し、統合する。これにより、顔の特徴（耳の形、目の色）と体型の特徴（毛並み、体格）を相補的に活用できる。

**アテンション機構**：CBAM（Convolutional Block Attention Module）[7]を導入し、品種識別に重要な領域に注目させる。これにより、背景ノイズの影響を軽減する。

**分類ヘッド**：50クラス（50品種）の分類を行う全結合層。「混血」クラスも含め、実用的な分類体系を構築した。

## Individual Identifier

Individual Identifierは、メトリック学習に基づく個体識別モジュールである。

**特徴抽出**：ResNet-18[9]ベースのエンコーダにより、128次元の特徴ベクトルを生成する。

**損失関数**：Triplet Loss[8]を採用し、同一個体の特徴ベクトルが近く、異なる個体の特徴ベクトルが遠くなるよう学習する。

**識別方法**：登録済み個体の特徴ベクトルとのコサイン類似度を計算し、閾値以上であれば同一個体と判定する。

## 軽量化手法

モデルサイズと推論速度の要件を満たすため、以下の軽量化手法を適用した。

1. **知識蒸留**[6]：大規模教師モデル（YOLOv8-large）から小規模生徒モデルへ知識を転移
2. **INT8量子化**：推論時の演算を8ビット整数で実行
3. **チャネル枝刈り**：重要度の低いチャネルを削除し、モデルを圧縮
